<!doctype html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Contact</title>
<link rel="stylesheet" href="/assets/css/style.css"></head>
<body>
<header class="header"><div class="container nav"><div class="brand"><div class="logo">CB</div><div>Cipherbikram</div></div></div></header>
<main class="container">
  <section class="hero-section hero-card center">
    <h1>Contact</h1>
    <p class="small-muted">Send me a message â€” uses Firebase (if configured) or Formspree as a fallback.</p>
    <form id="contactForm" action="https://formspree.io/f/your_form_id" method="POST" style="max-width:720px;margin:18px auto;display:flex;flex-direction:column;gap:10px">
      <input name="name" id="c_name" placeholder="Your name" required style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)">
      <input name="email" id="c_email" type="email" placeholder="Your email" required style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)">
      <textarea name="message" id="c_message" placeholder="Your Message" rows="6" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)"></textarea>
      <div style="display:flex;gap:10px;justify-content:flex-end"><button class="button" type="submit">Send message</button></div>
    </form>
    <div id="contactNotice" class="small-muted center" style="margin-top:8px"></div>
  </section>
</main>
<script src="/assets/js/firebase.js"></script>
<script>
document.getElementById('contactForm').addEventListener('submit', async function(e){
  // try Firebase first (if configured), otherwise allow normal Formspree POST
  e.preventDefault();
  const name = document.getElementById('c_name').value.trim();
  const email = document.getElementById('c_email').value.trim();
  const message = document.getElementById('c_message').value.trim();
  document.getElementById('contactNotice').innerText = 'Sending...';
  try {
    const fb = await initFirebaseIfConfigured();
    if(fb){
      await firebaseSaveMessage({name, email, message});
      document.getElementById('contactNotice').innerText = 'Message saved. Thank you!';
      document.getElementById('contactForm').reset();
      return;
    }
  } catch(err){
    console.error('Firebase submit failed', err);
  }
  // fallback to Formspree: submit via fetch so we don't navigate
  try {
    const form = e.target;
    const action = form.action;
    const resp = await fetch(action, {method:'POST', headers: {'Accept':'application/json'}, body: new FormData(form)});
    if(resp.ok){ document.getElementById('contactNotice').innerText = 'Message sent via Formspree. Thank you!'; form.reset(); }
    else { document.getElementById('contactNotice').innerText = 'Formspree error. Please try again.'; }
  } catch(err){ document.getElementById('contactNotice').innerText = 'Failed to send. Try again later.'; }
});
</script>
</body>
</html>
